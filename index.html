<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <title>åœŸå£Œè¨ºæ–­ãƒãƒƒãƒ—</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <style>
    body { margin: 0; }
    #map { height: 100vh; }
  </style>
</head>
<body>
  <div id="map"></div>
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script>
    const map = L.map('map').setView([36.0554, 139.0675], 15);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '&copy; OpenStreetMap contributors'
    }).addTo(map);

    fetch('soil.json')
      .then(res => res.json())
      .then(data => {
        data.forEach(soil => {
          // æ˜Ÿã®ç”Ÿæˆé–¢æ•°
          const stars = (n) => 'â˜…'.repeat(n) + 'â˜†'.repeat(5-n);

         /* index.html 29è¡Œç›®ä»˜è¿‘ã‹ã‚‰ã® markerColor æ±ºå®šãƒ­ã‚¸ãƒƒã‚¯ã‚’ä»¥ä¸‹ã«æ›¸ãæ›ãˆ */

          let markerColor;
          
          // åå‰ã«ã€Œéº¦ç•‘ã€ãŒå«ã¾ã‚Œã¦ã„ã‚‹å ´åˆ
          if (soil.name.includes('éº¦ç•‘')) {
            markerColor = '#8b4513'; // èŒ¶è‰² (SaddleBrown)
          } 
          // åå‰ã«ã€Œç•‘ã€ãŒå«ã¾ã‚Œã¦ã„ã‚‹å ´åˆï¼ˆã€Œéº¦ç•‘ã€ã§ãªã„ã‚‚ã®ï¼‰
          else if (soil.name.includes('ç•‘')) {
            markerColor = '#3e2723'; // æ¿ƒã„èŒ¶è‰² (Dark Brown)
          } 
          // ãã‚Œä»¥å¤–ã®æ—¢å­˜IDã®åˆ¤å®š
          else if (soil.soil_id === 'CHC-OTA-03') {
            markerColor = '#ffaa00'; // ã‚ªãƒ¬ãƒ³ã‚¸
          } else if (soil.soil_id === 'CHC-OTA-04') {
            markerColor = '#ffff00'; // é»„è‰²
          } else {
            markerColor = '#cccccc'; // ãã®ä»–ï¼ˆã‚°ãƒ¬ãƒ¼ï¼‰
          } 
          
          const popupContent = `
            <strong>${soil.name}</strong><br>
            <img src="${soil.story_image}" style="width:100%; max-width:180px; border-radius:4px; margin:8px 0;"><br>
            è©•ä¾¡ï¼š${soil.rank}<br>
            ${soil.summary}<br><br>
            ğŸš ãŠã„ã—ã•ï¼š${stars(soil.brand_scores.taste)}<br>
            ğŸŒ ç’°å¢ƒï¼š${stars(soil.brand_scores.environment)}<br>
            ğŸ›¡ å®‰å…¨ï¼š${stars(soil.brand_scores.safety)}<br><br>
            <a href="soil.html?id=${soil.soil_id}">è©³ç´°è¨ºæ–­ã‚’è¦‹ã‚‹</a>
          `;
          L.circleMarker([soil.lat, soil.lng], {
            radius: 10,           // åŠå¾„ï¼ˆãƒ¡ãƒ¼ãƒˆãƒ«ï¼‰ã€‚ã“ã“ã‚’èª¿æ•´ã™ã‚‹ã¨åœ°å›³ä¸Šã§ã®å¤§ãã•ãŒå¤‰ã‚ã‚Šã¾ã™
            color: '#333',         // ç¸å–ã‚Šã®è‰²ï¼ˆé»’ï¼‰
            weight: 1.5,             // ç¸å–ã‚Šã®å¤ªã•
            fillColor: markerColor,  // ä¸­ã®è‰²ï¼ˆã‚ªãƒ¬ãƒ³ã‚¸ç³»ï¼‰
            fillOpacity: 1.0       // é€æ˜åº¦
            })
            .addTo(map)
            .bindPopup(popupContent);
        });
      });
  </script>
</body>
</html>